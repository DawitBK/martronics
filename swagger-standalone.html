<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mart2 API Documentation</title>
  <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist@5.10.5/swagger-ui.css" />
  <style>
    body { margin: 0; padding: 0; }
  </style>
</head>
<body>
  <div id="swagger-ui"></div>
  <script src="https://unpkg.com/swagger-ui-dist@5.10.5/swagger-ui-bundle.js"></script>
  <script src="https://unpkg.com/swagger-ui-dist@5.10.5/swagger-ui-standalone-preset.js"></script>
  <script>
    window.onload = function() {
      const spec = {
        "openapi": "3.0.0",
        "info": {
          "title": "Mart2 E-commerce API",
          "version": "1.0.0",
          "description": "Complete API documentation for Mart2 e-commerce platform"
        },
        "servers": [
          { "url": "http://localhost:3000/api", "description": "Local development" },
          { "url": "https://mart2-production.up.railway.app/api", "description": "Production" }
        ],
        "components": {
          "securitySchemes": {
            "bearerAuth": {
              "type": "http",
              "scheme": "bearer",
              "bearerFormat": "JWT"
            }
          },
          "schemas": {
            "User": {
              "type": "object",
              "properties": {
                "id": { "type": "integer" },
                "email": { "type": "string" },
                "firstName": { "type": "string" },
                "lastName": { "type": "string" },
                "role": { "type": "string", "enum": ["user", "admin", "manager"] }
              }
            },
            "Product": {
              "type": "object",
              "properties": {
                "id": { "type": "integer" },
                "name": { "type": "string" },
                "description": { "type": "string" },
                "price": { "type": "number" },
                "stock": { "type": "integer" },
                "category_id": { "type": "integer" }
              }
            },
            "CartItem": {
              "type": "object",
              "properties": {
                "id": { "type": "integer" },
                "cart_id": { "type": "integer" },
                "product_id": { "type": "integer" },
                "quantity": { "type": "integer" },
                "product": { "$ref": "#/components/schemas/Product" }
              }
            },
            "Order": {
              "type": "object",
              "properties": {
                "id": { "type": "integer" },
                "user_id": { "type": "integer" },
                "total_amount": { "type": "number" },
                "status": { "type": "string", "enum": ["pending", "paid", "failed"] },
                "orderItems": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/OrderItem" }
                }
              }
            },
            "OrderItem": {
              "type": "object",
              "properties": {
                "id": { "type": "integer" },
                "order_id": { "type": "integer" },
                "product_id": { "type": "integer" },
                "quantity": { "type": "integer" },
                "price_at_purchase": { "type": "number" }
              }
            }
          }
        },
        "paths": {
          "/user/login": {
            "post": {
              "tags": ["Authentication"],
              "summary": "User login",
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": {
                      "type": "object",
                      "required": ["email", "password"],
                      "properties": {
                        "email": { "type": "string", "format": "email" },
                        "password": { "type": "string" }
                      }
                    }
                  }
                }
              },
              "responses": {
                "200": {
                  "description": "Login successful",
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "user": { "$ref": "#/components/schemas/User" },
                          "accessToken": { "type": "string" },
                          "refreshToken": { "type": "string" }
                        }
                      }
                    }
                  }
                },
                "400": { "description": "Invalid credentials" }
              }
            }
          },
          "/user": {
            "post": {
              "tags": ["Authentication"],
              "summary": "Register new user",
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": {
                      "type": "object",
                      "required": ["email", "password", "firstName", "lastName"],
                      "properties": {
                        "email": { "type": "string" },
                        "password": { "type": "string" },
                        "firstName": { "type": "string" },
                        "lastName": { "type": "string" }
                      }
                    }
                  }
                }
              },
              "responses": {
                "201": { "description": "User created" },
                "400": { "description": "Validation error" }
              }
            }
          },
          "/product": {
            "get": {
              "tags": ["Products"],
              "summary": "List all products",
              "responses": {
                "200": {
                  "description": "Products retrieved",
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "array",
                        "items": { "$ref": "#/components/schemas/Product" }
                      }
                    }
                  }
                }
              }
            },
            "post": {
              "tags": ["Products"],
              "summary": "Create product (admin only)",
              "security": [{ "bearerAuth": [] }],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/Product" }
                  }
                }
              },
              "responses": {
                "201": { "description": "Product created" },
                "401": { "description": "Unauthorized" }
              }
            }
          },
          "/product/{id}": {
            "get": {
              "tags": ["Products"],
              "summary": "Get product by ID",
              "parameters": [
                {
                  "name": "id",
                  "in": "path",
                  "required": true,
                  "schema": { "type": "integer" }
                }
              ],
              "responses": {
                "200": {
                  "description": "Product found",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/Product" }
                    }
                  }
                },
                "404": { "description": "Product not found" }
              }
            },
            "put": {
              "tags": ["Products"],
              "summary": "Update product (admin only)",
              "security": [{ "bearerAuth": [] }],
              "parameters": [
                {
                  "name": "id",
                  "in": "path",
                  "required": true,
                  "schema": { "type": "integer" }
                }
              ],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": { "$ref": "#/components/schemas/Product" }
                  }
                }
              },
              "responses": {
                "200": { "description": "Product updated" },
                "404": { "description": "Product not found" }
              }
            },
            "delete": {
              "tags": ["Products"],
              "summary": "Delete product (admin only)",
              "security": [{ "bearerAuth": [] }],
              "parameters": [
                {
                  "name": "id",
                  "in": "path",
                  "required": true,
                  "schema": { "type": "integer" }
                }
              ],
              "responses": {
                "200": { "description": "Product deleted" },
                "404": { "description": "Product not found" }
              }
            }
          },
          "/cart/user/{userId}": {
            "get": {
              "tags": ["Cart"],
              "summary": "Get user's cart",
              "security": [{ "bearerAuth": [] }],
              "parameters": [
                {
                  "name": "userId",
                  "in": "path",
                  "required": true,
                  "schema": { "type": "integer" }
                }
              ],
              "responses": {
                "200": {
                  "description": "Cart retrieved",
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "id": { "type": "integer" },
                          "user_id": { "type": "integer" },
                          "items": {
                            "type": "array",
                            "items": { "$ref": "#/components/schemas/CartItem" }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "/cart/items": {
            "post": {
              "tags": ["Cart"],
              "summary": "Add item to cart",
              "security": [{ "bearerAuth": [] }],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": {
                      "type": "object",
                      "required": ["cart_id", "product_id", "quantity"],
                      "properties": {
                        "cart_id": { "type": "integer" },
                        "product_id": { "type": "integer" },
                        "quantity": { "type": "integer", "minimum": 1 }
                      }
                    }
                  }
                }
              },
              "responses": {
                "201": { "description": "Item added to cart" },
                "400": { "description": "Invalid request" }
              }
            }
          },
          "/cart/items/{itemId}": {
            "put": {
              "tags": ["Cart"],
              "summary": "Update cart item quantity",
              "security": [{ "bearerAuth": [] }],
              "parameters": [
                {
                  "name": "itemId",
                  "in": "path",
                  "required": true,
                  "schema": { "type": "integer" }
                }
              ],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": {
                      "type": "object",
                      "required": ["quantity"],
                      "properties": {
                        "quantity": { "type": "integer", "minimum": 1 }
                      }
                    }
                  }
                }
              },
              "responses": {
                "200": { "description": "Item updated" },
                "404": { "description": "Item not found" }
              }
            },
            "delete": {
              "tags": ["Cart"],
              "summary": "Remove item from cart",
              "security": [{ "bearerAuth": [] }],
              "parameters": [
                {
                  "name": "itemId",
                  "in": "path",
                  "required": true,
                  "schema": { "type": "integer" }
                }
              ],
              "responses": {
                "200": { "description": "Item removed" },
                "404": { "description": "Item not found" }
              }
            }
          },
          "/order": {
            "get": {
              "tags": ["Orders"],
              "summary": "List all orders",
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": {
                  "description": "Orders retrieved",
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "array",
                        "items": { "$ref": "#/components/schemas/Order" }
                      }
                    }
                  }
                }
              }
            },
            "post": {
              "tags": ["Orders"],
              "summary": "Create new order",
              "security": [{ "bearerAuth": [] }],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": {
                      "type": "object",
                      "required": ["user_id", "items"],
                      "properties": {
                        "user_id": { "type": "integer" },
                        "items": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "required": ["product_id", "quantity"],
                            "properties": {
                              "product_id": { "type": "integer" },
                              "quantity": { "type": "integer", "minimum": 1 }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              },
              "responses": {
                "201": {
                  "description": "Order created",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/Order" }
                    }
                  }
                },
                "400": { "description": "Invalid request" },
                "404": { "description": "User not found" }
              }
            }
          },
          "/order/{id}": {
            "get": {
              "tags": ["Orders"],
              "summary": "Get order by ID",
              "security": [{ "bearerAuth": [] }],
              "parameters": [
                {
                  "name": "id",
                  "in": "path",
                  "required": true,
                  "schema": { "type": "integer" }
                }
              ],
              "responses": {
                "200": {
                  "description": "Order found",
                  "content": {
                    "application/json": {
                      "schema": { "$ref": "#/components/schemas/Order" }
                    }
                  }
                },
                "404": { "description": "Order not found" }
              }
            }
          }
        }
      };

      SwaggerUIBundle({
        spec: spec,
        dom_id: '#swagger-ui',
        deepLinking: true,
        presets: [
          SwaggerUIBundle.presets.apis,
          SwaggerUIStandalonePreset
        ],
        plugins: [
          SwaggerUIBundle.plugins.DownloadUrl
        ],
        layout: "StandaloneLayout"
      });
    };
  </script>
</body>
</html>
